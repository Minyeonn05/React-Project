<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">


<!-- Mirrored from themesflat.co/html/ecomus/my-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 02 Sep 2024 12:27:45 GMT -->

<head>
    <meta charset="utf-8">
    <title>Ecomus - Ultimate HTML</title>

    <meta name="author" content="themesflat.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- font -->
    <link rel="stylesheet" href="fonts/fonts.css">
    <!-- Icons -->
    <link rel="stylesheet" href="fonts/font-icons.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/swiper-bundle.min.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/styles.css" />

    <!-- Favicon and Touch Icons  -->
    <link rel="shortcut icon" href="images/logo/favicon.png">
    <link rel="apple-touch-icon-precomposed" href="images/logo/favicon.png">

</head>

<body class="preload-wrapper">

    <div id="wrapper">
        <!-- header -->
        <header id="header" class="header-default header-absolute">
            <div class="px_15 lg-px_40">
                <div class="row wrapper-header align-items-center">
                    <div class="col-md-4 col-3 tf-lg-hidden">
                        <a href="#mobileMenu" data-bs-toggle="offcanvas" aria-controls="offcanvasLeft">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="16" viewBox="0 0 24 16"
                                fill="none">
                                <path
                                    d="M2.00056 2.28571H16.8577C17.1608 2.28571 17.4515 2.16531 17.6658 1.95098C17.8802 1.73665 18.0006 1.44596 18.0006 1.14286C18.0006 0.839753 17.8802 0.549063 17.6658 0.334735C17.4515 0.120408 17.1608 0 16.8577 0H2.00056C1.69745 0 1.40676 0.120408 1.19244 0.334735C0.978109 0.549063 0.857702 0.839753 0.857702 1.14286C0.857702 1.44596 0.978109 1.73665 1.19244 1.95098C1.40676 2.16531 1.69745 2.28571 2.00056 2.28571ZM0.857702 8C0.857702 7.6969 0.978109 7.40621 1.19244 7.19188C1.40676 6.97755 1.69745 6.85714 2.00056 6.85714H22.572C22.8751 6.85714 23.1658 6.97755 23.3801 7.19188C23.5944 7.40621 23.7148 7.6969 23.7148 8C23.7148 8.30311 23.5944 8.59379 23.3801 8.80812C23.1658 9.02245 22.8751 9.14286 22.572 9.14286H2.00056C1.69745 9.14286 1.40676 9.02245 1.19244 8.80812C0.978109 8.59379 0.857702 8.30311 0.857702 8ZM0.857702 14.8571C0.857702 14.554 0.978109 14.2633 1.19244 14.049C1.40676 13.8347 1.69745 13.7143 2.00056 13.7143H12.2863C12.5894 13.7143 12.8801 13.8347 13.0944 14.049C13.3087 14.2633 13.4291 14.554 13.4291 14.8571C13.4291 15.1602 13.3087 15.4509 13.0944 15.6653C12.8801 15.8796 12.5894 16 12.2863 16H2.00056C1.69745 16 1.40676 15.8796 1.19244 15.6653C0.978109 15.4509 0.857702 15.1602 0.857702 14.8571Z"
                                    fill="currentColor"></path>
                            </svg>
                        </a>
                    </div>
                    <div class="col-xl-3 col-md-4 col-6">
                        <a href="#" class="logo-header">
                            <img src="images/logo/logo.svg" alt="logo" class="logo">
                        </a>
                    </div>
                    <!-- <div class="col-xl-6 tf-md-hidden">
                        <nav class="box-navigation text-center">
                            <ul class="box-nav-ul d-flex align-items-center justify-content-center gap-30">
                                <li class="menu-item">
                                    <a href="index.html" class="item-link">Home</a>

                                </li>
                                <li class="menu-item">
                                    <a href="shop-default.html" class="item-link">Shop</a>

                                </li>
                                
                                <li class="menu-item position-relative">
                                    <a href="about-us.html" class="item-link">About us</a>

                                </li>

                            </ul>
                        </nav>
                    </div>
                    <div class="col-xl-3 col-md-4 col-3">
                        <ul class="nav-icon d-flex justify-content-end align-items-center gap-20">
                            
                            <li class="nav-account"><a href="#login" data-bs-toggle="modal" class="nav-icon-item"><i
                                        class="icon icon-account" onclick="checkloged()"></i></a></li>

                            <li class="nav-cart"><a href="#shoppingCart" data-bs-toggle="modal" class="nav-icon-item"><i
                                        class="icon icon-bag"></i><span class="count-box">0</span></a></li>
                        </ul>
                    </div> -->
                </div>
            </div>
        </header>
        <!-- /header -->

        <!-- page-title -->
        <div class="tf-page-title">
            <div class="container-full">
                <div class="heading text-center">Admin</div>
            </div>
        </div>
        <!-- /page-title -->

        <!-- page-cart -->
        <section class="flat-spacing-11">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3">
                        <ul class="my-account-nav">
                            <li><a href="admin.html" class="my-account-nav-item">Products</a></li>
                            <li><a href="#" class="my-account-nav-item">Order</a></li>

                            <li><a onclick="logout()" class="my-account-nav-item">Logout</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-9">
                        <table class="table">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col">Email</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Item</th>
                                    <th scope="col">Size</th>
                                    <th scope="col">Amount</th>
                                    <th scope="col">Address</th>
                                </tr>
                            </thead>
                            <tbody id="order-list">
                                <tr>
                                    <th scope="row">1</th>
                                    <td>Mark</td>
                                    <td>Otto</td>
                                    <td>@mdo</td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td>Jacob</td>
                                    <td>Thornton</td>
                                    <td>@fat</td>
                                </tr>
                                <tr>
                                    <th scope="row">3</th>
                                    <td>Larry</td>
                                    <td>the Bird</td>
                                    <td>@twitter</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        <!-- page-cart -->

        <div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">Add Product</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="editModalBody">
                        <form>
                            <div class="mb-3">
                                <label for="addProductId" class="form-label">Product ID</label>
                                <input type="text" class="form-control" id="addProductId">
                            </div>
                            <div class="mb-3">
                                <label for="addProductName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="addProductName">
                            </div>
                            <div class="mb-3">
                                <label for="addProductImg" class="form-label">Image</label>
                                <input class="form-control form-control-sm" id="addProductImg1" type="file">
                                <input class="form-control form-control-sm" id="addProductImg2" type="file">
                                <input class="form-control form-control-sm" id="addProductImg3" type="file">
                                <input class="form-control form-control-sm" id="addProductImg4" type="file">
                                <input class="form-control form-control-sm" id="addProductImg5" type="file">
                            </div>
                            <div class="mb-3">
                                <label for="addProductPrice" class="form-label">Price</label>
                                <input type="number" class="form-control" id="addProductPrice">
                            </div>
                            <div class="mb-3">
                                <label for="addProductDetails" class="form-label">Details</label>
                                <textarea class="form-control" id="addProductDetails" rows="3"></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="addProductType" class="form-label">Type</label>
                                <input type="text" class="form-control" id="addProductType">
                            </div>
                            <div class="mb-3">
                                <label for="addProductSize" class="form-label">Size</label>
                                <input type="text" class="form-control" id="addProductSize" placeholder="e.g., S, M, L">
                            </div>
                            <div class="form-check mb-3"> <input class="form-check-input" type="checkbox"
                                    id="addProductOnShop">
                                <label class="form-check-label" for="addProductOnShop">
                                    On Shop
                                </label>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="addProductBtn">Add</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="sizeModal" tabindex="-1" aria-labelledby="sizeModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="sizeModalLabel">Product Sizes</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="sizeModalBody">
                        <div class="col-lg-9">
                            <div class="mb-3">
                                <label for="newSizeInput" class="form-label">Size</label>
                                <input type="text" class="form-control" id="newSizeInput" placeholder="e.g., S, M, L">
                            </div>
                            <div class="form-check mb-3"> <input class="form-check-input" type="checkbox"
                                    id="newOnShopInput">
                                <label class="form-check-label" for="newOnShopInput">
                                    On Shop
                                </label>
                            </div>
                            <hr>
                            <table class="table">
                                <thead class="thead-dark">
                                    <tr>
                                        <th scope="col">id</th>
                                        <th scope="col">size</th>
                                        <th scope="col">OnShop</th>
                                        <th scope="col">Remove</th>
                                    </tr>
                                </thead>
                                <tbody id="sizes-list">
                                    <tr>
                                        <th scope="row">1</th>
                                        <td>Mark</td>
                                        <td>Otto</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">2</th>
                                        <td>Jacob</td>
                                        <td>Thornton</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">3</th>
                                        <td>Larry</td>
                                        <td>the Bird</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" id="addSizeBtn">Update</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">Edit Product</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="editModalBody">
                        <form>
                            <div class="mb-3">
                                <label for="editProductId" class="form-label">Product ID</label>
                                <input type="text" class="form-control" id="editProductId" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="editProductName" class="form-label">Product Name</label>
                                <input type="text" class="form-control" id="editProductName">
                            </div>
                            <div class="mb-3">
                                <label for="editProductImg" class="form-label">Image</label>
                                <input class="form-control form-control-sm" id="editProductImg1" type="file">
                                <input class="form-control form-control-sm" id="editProductImg2" type="file">
                                <input class="form-control form-control-sm" id="editProductImg3" type="file">
                                <input class="form-control form-control-sm" id="editProductImg4" type="file">
                                <input class="form-control form-control-sm" id="editProductImg5" type="file">
                            </div>
                            <div class="mb-3">
                                <label for="editProductPrice" class="form-label">Price</label>
                                <input type="number" class="form-control" id="editProductPrice">
                            </div>
                            <div class="mb-3">
                                <label for="editProductDetails" class="form-label">Details</label>
                                <textarea class="form-control" id="editProductDetails" rows="3"></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="editProductType" class="form-label">Type</label>
                                <input type="text" class="form-control" id="editProductType">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="editProductBtn">Save Changes</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="removeModal" tabindex="-1" aria-labelledby="removeModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="removeModalLabel">Remove Product</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="removeModalBody">
                        Are you sure you want to remove product <span id="removeProductId"></span>?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmRemoveBtn">Remove</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="removeSize" tabindex="-1" aria-labelledby="removeSizeLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="removeSizeLabel">Remove Size in Product</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" id="removeSizeBody">
                        Are you sure you want to remove size in product <span id="removeSizeId"></span> - <span
                            id="removeSizeName">?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmRemoveSizeBtn">Remove</button>
                    </div>
                </div>
            </div>
        </div>



        <!-- Javascript -->
        <script type="text/javascript" src="js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/swiper-bundle.min.js"></script>
        <script type="text/javascript" src="js/carousel.js"></script>

        <script type="text/javascript" src="js/bootstrap-select.min.js"></script>
        <script type="text/javascript" src="js/lazysize.min.js"></script>
        <script type="text/javascript" src="js/count-down.js"></script>
        <script type="text/javascript" src="js/wow.min.js"></script>
        <script type="text/javascript" src="js/wow.min.js"></script>
        <script type="text/javascript" src="js/multiple-modal.js"></script>
        <script type="text/javascript" src="js/main.js"></script>
        <script type="text/javascript" src="js/main.js"></script>

        <script type="text/javascript" src="js/main.js"></script>

        <script>
            //AJAX function
            const ajax = async (config) => {
                const request = await fetch(config.url, {
                    method: config.method,
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(config.data)
                });
                const response = await request.json();
                console.log(reponse.status);
                return response;
            }
            document.addEventListener('DOMContentLoaded', function () {
                // ดึงข้อมูลผู้ใช้จาก localStorage
                const loggedInUser = localStorage.getItem('loggedInUser');

                if (loggedInUser) {
                    const user = JSON.parse(loggedInUser);
                    const greetingElement = document.getElementById('greeting-message');

                    if (greetingElement && user.fname) {
                        // เปลี่ยนข้อความทักทาย
                        greetingElement.textContent = `Hello ${user.fname}`;
                    }
                } else {
                    // ถ้าไม่มีข้อมูลใน localStorage (ยังไม่ได้ล็อกอิน) ให้กลับไปหน้าแรก
                    alert('Please log in to view your account.');
                    window.location.href = 'index.html';
                }

                // จัดการการ Logout
                const logoutButton = document.querySelector('.my-account-nav-item[href="index.html"]');
                if (logoutButton) {
                    logoutButton.addEventListener('click', function (event) {
                        event.preventDefault(); // หยุดการไปที่ login.html ทันที
                        localStorage.removeItem('loggedInUser'); // ลบข้อมูลผู้ใช้ออกจาก localStorage
                        alert('You have been logged out.');
                        window.location.href = 'index.html'; // กลับไปที่หน้าแรก
                    });
                }
            });
            // Function to handle user logout
            function logout() {
                alert('You have been logged out.');
                // Clear both localStorage and sessionStorage for user info
                localStorage.removeItem('loggedInUser');

                // Redirect to the login page
                window.location.href = 'index.html';
            }
            // This function fetches data from the specified URL and then passes it to the 'order' function for display.
            function loadOrder(url) {
                fetch(url)
                    .then(response => {
                        // Check if the response is OK (status 200-299)
                        if (!response.ok) {
                            // If not OK, throw an error to be caught by the .catch block
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json(); // Parse the JSON response
                    })
                    .then(data => {
                        // Log the received data for debugging purposes
                        //console.log("Fetched Data:", data);
                        order(data); // Call the order function with the parsed data
                    })
                    .catch(error => {
                        // Handle any errors that occurred during the fetch operation
                        console.error("Error fetching orders:", error);
                        // Optionally display a user-friendly message in the UI
                        const select = document.getElementById("order-list");
                        select.innerHTML = `<tr><td colspan="6" class="text-center text-red-500">Failed to load orders. Please try again later.</td></tr>`;
                    });
            }

            // This function takes the order data and populates the HTML table.
            function order(data) {
                const select = document.getElementById("order-list");
                // Clear any existing content in the table body before adding new rows
                select.innerHTML = '';

                // Check if the data is an array and has elements
                if (!Array.isArray(data) || data.length === 0) {
                    select.innerHTML = `<tr><td colspan="6" class="text-center text-gray-500">No orders found.</td></tr>`;
                    return;
                }

                // Iterate over each user's complete order object in the 'data' array
                // Each 'userOrder' object contains: { email, name, orders: [...], address }
                data.forEach(userOrder => {
                    // Create a new table row for each user's order
                    let show = true;
                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b hover:bg-gray-50'; // Tailwind classes for styling

                    // Initialize HTML strings for items, sizes, and amounts as unordered lists
                    let itemsHtml = '<ul>';
                    let sizesHtml = '<ul>';
                    let amountsHtml = '<ul>';

                    // Check if userOrder.orders is an array and has elements
                    if (Array.isArray(userOrder.orders) && userOrder.orders.length > 0) {
                        // Iterate over each individual item within the user's 'orders' array
                        // Each 'itemDetail' object contains: { item, size, amount }
                        userOrder.orders.forEach(itemDetail => {
                            itemDetail.forEach(items =>{
                                itemsHtml += `<li class="px-1 py-0.5">${items.item || 'N/A'}</li>`;
                                sizesHtml += `<li class="px-1 py-0.5">${items.size || 'N/A'}</li>`;
                                amountsHtml += `<li class="px-1 py-0.5">${items.amount || 'N/A'}</li>`;
                            })
                        });
                    } else {
                        // If no individual order items, display a placeholder
                        show = false;
                        itemsHtml += `<li class="px-1 py-0.5 text-gray-400">No items</li>`;
                        sizesHtml += `<li class="px-1 py-0.5 text-gray-400">N/A</li>`;
                        amountsHtml += `<li class="px-1 py-0.5 text-gray-400">N/A</li>`;
                    }

                    itemsHtml += '</ul>';
                    sizesHtml += '</ul>';
                    amountsHtml += '</ul>';

                    // Populate the table row with the user's order details
                    row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${userOrder.email || 'N/A'}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${userOrder.name || 'N/A'}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${itemsHtml}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${sizesHtml}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${amountsHtml}</td>
            <td class="px-6 py-4 text-sm text-gray-900">${userOrder.address || 'N/A'}</td>
        `;

                    // Append the completed row to the table body
                    if(show){
                        select.appendChild(row);
                    }
                });
            }


            // --- ส่วนของการตั้งเวลา Polling ---
            // กำหนดช่วงเวลา (เป็นมิลลิวินาที) เช่น 5000ms = 5 วินาที
            const POLLING_INTERVAL = 5000; // 5 วินาที

            window.onload = function () {
                //loadProduct('http://localhost:5000/api/products');
                loadOrder('http://localhost:5000/api/users/getOrderAll');

                // ตั้งค่าให้ loadProduct ถูกเรียกซ้ำทุกๆ POLLING_INTERVAL
                setInterval(loadOrder('http://localhost:5000/api/users/getOrderAll'), POLLING_INTERVAL);
            }
        </script>
</body>
</body>


<!-- Mirrored from themesflat.co/html/ecomus/my-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 02 Sep 2024 12:27:48 GMT -->

</html>